<!DOCTYPE html>
<html>
<head>
  <title>Kitchen Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      padding: 20px;
    }

    .order {
      background: white;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    .order h3 {
      margin: 0 0 10px 0;
    }

    .item {
      margin-left: 15px;
    }

    .status {
      font-weight: bold;
      color: orange;
    }
  </style>
</head>
<body>

  <h1>üç≥ Kitchen Orders</h1>
  <div id="orders">Loading...</div>

  <script>
    async function loadOrders() {
      const res = await fetch("http://localhost:3000/api/orders");
      const orders = await res.json();
      const container = document.getElementById("orders");
      container.innerHTML = "";

      if (orders.length === 0) {
        container.innerHTML = "<p>No active orders.</p>";
        return;
      }

      orders.forEach(order => {
        console.log(order);
  const div = document.createElement("div");
  div.className = "order";

  div.innerHTML = `
    <h3>Table: ${order.table_name}</h3>
    <p>Status: <span class="status">${order.status}</span></p>
    <ul>
      ${order.items.map(i =>
        `<li class="item">${i.quantity} √ó ${i.name}</li>`
      ).join("")}
    </ul>

    ${order.status === "pending" ? `
  <button onclick="updateStatus(${order.order_id}, 'preparing')">
    Preparing
  </button>
` : ""}

${order.status === "preparing" ? `
  <button onclick="updateStatus(${order.order_id}, 'served')">
    Served
  </button>
` : ""}
`;

  container.appendChild(div);
});

    }

    loadOrders();
    
    async function updateStatus(orderId, status) {
  await fetch(`http://localhost:3000/api/orders/${orderId}/status`, {
    method: "PATCH",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ status })
  });

  loadOrders();
}

    setInterval(loadOrders, 5000); // refresh every 5s
  </script>

</body>
</html>
